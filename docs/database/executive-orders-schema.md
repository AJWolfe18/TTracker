# Executive Orders Database Schema
*Last Updated: September 3, 2025*

## Table: `executive_orders`

This table stores all Executive Orders tracked by TrumpyTracker.

### Current Schema Fields

| Field Name | Type | Description | Required | Notes |
|------------|------|-------------|----------|-------|
| `id` | TEXT | Unique identifier | Yes | Auto-generated, format: `eo_timestamp_random` |
| `title` | TEXT | Official title of the EO | Yes | From Federal Register |
| `order_number` | TEXT | Executive Order number | Yes | e.g., "14343", "14344" |
| `date` | DATE | Publication date | Yes | ISO format |
| `summary` | TEXT | AI-generated summary of the order | Yes | Generated by OpenAI, fallback to abstract |
| `category` | TEXT | Policy category | Yes | e.g., "immigration", "healthcare", "defense" |
| `agencies_affected` | TEXT[] | List of affected agencies | No | Array of agency names |
| `source_url` | TEXT | Link to official source | Yes | Federal Register or WhiteHouse.gov |
| `pdf_url` | TEXT | Link to PDF version | No | If available |
| `citation` | TEXT | Official citation | No | Legal citation format |
| `publication_date` | DATE | Federal Register publication | No | May differ from date |
| `document_number` | TEXT | Federal Register document ID | No | For tracking |
| `source` | TEXT | Data source | Yes | Default: "Federal Register API" |
| `verified` | BOOLEAN | Verification status | Yes | Default: true |
| `added_at` | TIMESTAMP | When added to database | Yes | Auto-generated |
| `impact_score` | INTEGER | Calculated impact (0-100) | Yes | Based on keywords and scope |
| `implementation_status` | TEXT | Current status | Yes | Default: "issued" |
| `severity_rating` | TEXT | AI severity assessment | Yes | "low", "medium", "high" |
| `policy_direction` | TEXT | Policy direction | Yes | "expand", "restrict", "modify", "create", "eliminate" |
| `implementation_timeline` | TEXT | Timeline for implementation | Yes | "immediate", "30_days", "90_days", "ongoing" |
| `impact_areas` | TEXT[] | Policy areas affected | No | Array of areas |
| `full_text_available` | BOOLEAN | Full text availability | Yes | Default: true |
| `type` | TEXT | Document type | Yes | Default: "executive_order" |
| `legal_challenges` | TEXT[] | Legal challenges filed | No | Array of challenge info |
| `related_orders` | TEXT[] | Related EO numbers | No | Array of related orders |
| `archived` | BOOLEAN | Archive status | No | Default: false |

### Spicy Summary Fields (GPT-5 Enhanced)

| Field Name | Type | Description | Required | Notes |
|------------|------|-------------|----------|-------|
| `eo_impact_type` | TEXT | Impact categorization | No | "fascist_power_grab", "authoritarian_overreach", "corrupt_grift", "performative_bullshit" |
| `spicy_summary` | TEXT | Angry, truthful translation | No | Generated by GPT-5, exposes real agenda |
| `shareable_hook` | TEXT | Social media hook | No | <280 chars for sharing |
| `severity_label_inapp` | TEXT | In-app severity display | No | e.g., "Fascist Power Grab 🔴" |
| `severity_label_share` | TEXT | Shareable severity label | No | Cleaner version for social media |

### Fields NOT in Database (Common Mistakes)

⚠️ **These fields do NOT exist and will cause errors:**
- `editorial_summary` - Use `summary` instead
- `source` field in political_entries table - Removed in favor of source_url
- Any JSONB fields - Not currently used in this table

## Dashboard Usage

The dashboard (`dashboard-components.js`) uses these fields:

```javascript
// Primary display logic
const displaySummary = order.spicy_summary || order.summary;

// Key fields used:
- order.title
- order.order_number  
- order.date
- order.summary (fallback)
- order.spicy_summary (primary if available)
- order.shareable_hook
- order.source_url
- order.category
- order.eo_impact_type
- order.severity_label_inapp
```

## API Integration Notes

### Federal Register API
- Must specify `fields[]` parameters to get `executive_order_number`
- Use `presidential_document_type=executive_order` not type_id
- Returns ~190 orders since Jan 20, 2025

### OpenAI Integration
1. Basic summary generation (gpt-4o-mini)
2. Spicy translation generation (gpt-5-mini or gpt-5)
3. Cost: ~$0.00054-0.00255 per order

## Common Issues & Solutions

### Issue: "Could not find 'editorial_summary' column"
**Cause:** Field doesn't exist in database  
**Solution:** Remove the field from insert, use `summary` field instead

### Issue: "Could not find 'source' column" 
**Cause:** Field was removed from political_entries  
**Solution:** Use `source_url` instead

### Issue: Missing executive_order_number from API
**Cause:** Not requesting the field explicitly  
**Solution:** Add `fields[]=executive_order_number` to API call

## Migration History

- **Aug 2025**: Initial schema created
- **Aug 2025**: Added spicy summary fields
- **Sept 2025**: Removed editorial_summary (never implemented)

## Related Documentation

- `/docs/executive-orders-collection.md` - Collection process
- `/docs/spicy-summaries-implementation.md` - GPT-5 integration
- `/scripts/executive-orders-tracker-supabase.js` - Implementation
