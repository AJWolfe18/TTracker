# Political Entries Database Schema
*Last Updated: September 3, 2025*

## Table: `political_entries`

This table stores all political news articles and events tracked by TrumpyTracker.

### Current Schema Fields

| Field Name | Type | Description | Required | Notes |
|------------|------|-------------|----------|-------|
| `id` | SERIAL | Auto-incrementing ID | Yes | Primary key, database-generated |
| `title` | TEXT | Article/entry title | Yes | From source article |
| `source_url` | TEXT | Link to source article | Yes | Original article URL |
| `description` | TEXT | Summary/description | Yes | AI-generated or from article |
| `category` | TEXT | Content category | Yes | e.g., "Democracy & Rule of Law", "Corruption" |
| `date` | DATE | Publication date | Yes | ISO format |
| `actor` | TEXT | Primary political actor | No | e.g., "Donald Trump", "Political Actor" |
| `severity` | TEXT | Severity rating | Yes | "low", "medium", "high", "critical" |
| `verified` | BOOLEAN | Verification status | No | Default: false |
| `added_at` | TIMESTAMP | When added to database | Yes | Auto-generated |
| `archived` | BOOLEAN | Archive status | No | Default: false, for hiding entries |

### Spicy Summary Fields (GPT-5 Enhanced)

| Field Name | Type | Description | Required | Notes |
|------------|------|-------------|----------|-------|
| `spicy_summary` | TEXT | Angry, truthful translation | No | Generated by GPT-5, exposes real agenda |
| `shareable_hook` | TEXT | Social media hook | No | <280 chars for sharing |
| `severity_label_inapp` | TEXT | In-app severity display | No | e.g., "Democracy Threat 🔴" |
| `severity_label_share` | TEXT | Shareable severity label | No | Cleaner version for social media |
| `impact_type` | TEXT | Impact categorization | No | Similar to EO impact types |

### Fields NOT in Database (Common Mistakes)

⚠️ **These fields do NOT exist and will cause errors:**
- `source` - Removed in favor of `source_url`
- `editorial_summary` - Use `description` field instead
- `id` as string - It's SERIAL (integer), not text
- `status` - Never existed, do not use
- `manual_submission` - Never existed, do not use

## Important Notes

### ID Generation
- **DO NOT** manually set the `id` field
- Database uses SERIAL type (auto-incrementing integer)
- Let Supabase handle ID generation automatically

### Source Field History
The `source` field was removed because:
1. It duplicated information from `source_url`
2. Caused insertion errors in manual article processor
3. The hostname can be extracted from `source_url` if needed

## Dashboard Usage

The dashboard (`dashboard-components.js`) uses these fields:

```javascript
// Primary display logic
const displaySummary = entry.spicy_summary || entry.description;

// Key fields used:
- entry.title
- entry.date
- entry.actor
- entry.severity
- entry.description (fallback)
- entry.spicy_summary (primary if available)
- entry.shareable_hook
- entry.source_url
- entry.category
- entry.severity_label_inapp
```

## Common Issues & Solutions

### Issue: "Could not find 'source' column"
**Cause:** Field was removed from schema  
**Solution:** Remove from insert, use `source_url` only

### Issue: "value out of range for type integer" 
**Cause:** Trying to set string ID on SERIAL column  
**Solution:** Don't set ID, let database auto-generate

### Issue: Duplicate entries
**Cause:** Same URL processed multiple times  
**Solution:** Check for existing URL before insert

## Migration History

- **Jan 2025**: Initial schema created
- **Aug 2025**: Removed `source` field
- **Aug 2025**: Added spicy summary fields
- **Sept 2025**: Documentation updated

## Related Documentation

- `/docs/daily-tracker-implementation.md` - Collection process
- `/docs/manual-article-processor.md` - Manual submission
- `/scripts/daily-tracker-supabase.js` - Implementation
